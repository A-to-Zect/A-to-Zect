<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ê²Œì‹œê¸€ ë³´ê¸°</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        /* --- ê²Œì‹œê¸€ ì˜ì—­ ìŠ¤íƒ€ì¼ --- */
        .post-header {
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .post-title {
            font-size: 26px;
            font-weight: 800;
            color: #333;
            margin: 0 0 15px 0;
            line-height: 1.3;
        }
        .post-meta {
            font-size: 14px;
            color: #666;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 8px;
        }
        .post-content {
            min-height: 300px;
            line-height: 1.8;
            white-space: pre-wrap; /* ì¤„ë°”ê¿ˆ ìœ ì§€ */
            color: #333;
            font-size: 16px;
            margin-bottom: 40px;
        }

        /* ë²„íŠ¼ í¬ê¸° ê°•ì œ í†µì¼ (ê²Œì‹œê¸€ ìˆ˜ì •/ì‚­ì œìš©) */
        .btn-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 50px; /* ëŒ“ê¸€ ì˜ì—­ê³¼ ê±°ë¦¬ ë‘ê¸° */
        }
        .author-actions { display: flex; gap: 8px; }

        .btn-fixed {
            height: 40px !important;
            line-height: 38px !important;
            padding: 0 20px !important;
            font-size: 14px !important;
            display: inline-flex !important;
            align-items: center;
            justify-content: center;
            box-sizing: border-box !important;
            margin: 0 !important;
            text-decoration: none !important;
            border-radius: 6px !important;
        }

        /* --- ëŒ“ê¸€ ì˜ì—­ ìŠ¤íƒ€ì¼ --- */
        .reply-section {
            border-top: 2px solid #333;
            padding-top: 30px;
        }
        .reply-header {
            font-size: 18px; font-weight: bold; margin-bottom: 15px; color: #333;
        }

        /* ê°œë³„ ëŒ“ê¸€ ì¹´ë“œ */
        .reply-item {
            background: #fff;
            border-bottom: 1px solid #eee;
            padding: 20px 10px;
        }
        .reply-item:last-child { border-bottom: none; }

        .reply-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .reply-author { font-weight: bold; font-size: 15px; color: #333; }
        .reply-date { font-size: 12px; color: #999; margin-left: 10px; }
        .reply-content {
            font-size: 14px; color: #555; line-height: 1.6; white-space: pre-wrap;
        }

        /* ëŒ“ê¸€ ì‚­ì œ ë²„íŠ¼ (ì‘ê²Œ) */
        .btn-reply-delete {
            background: none; border: none; color: #dc3545;
            font-size: 12px; cursor: pointer; padding: 0;
            text-decoration: underline;
        }
        .btn-reply-delete:hover { font-weight: bold; }

        /* ëŒ“ê¸€ ì‘ì„± í¼ */
        .reply-form {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            border: 1px solid #eee;
        }
        .reply-textarea {
            width: 100%; height: 80px; border: 1px solid #ddd;
            border-radius: 6px; padding: 10px; resize: none; font-size: 14px;
            margin-bottom: 10px;
        }
        .reply-textarea:focus { border-color: #007bff; outline: none; }
    </style>
</head>
<body>

<div class="container" style="max-width: 800px;">

    <div class="post-header">
        <h1 class="post-title" th:text="${post.title}">ê²Œì‹œê¸€ ì œëª©</h1>
        <div class="post-meta">
            <div>
                <span style="color: #888;">ì‘ì„±ì</span>
                <strong style="color: #333; margin-left: 5px;" th:text="${authorName}">í™ê¸¸ë™</strong>
            </div>

            <div style="color: #888;">
                <span th:text="${#temporals.format(post.modifiedAt, 'yyyy-MM-dd HH:mm')}">2025-11-25 19:21</span>
            </div>
        </div>
    </div>

    <div class="post-content" th:text="${post.content}">
        ë‚´ìš©ì´ ë“¤ì–´ê°‘ë‹ˆë‹¤...
    </div>

    <div class="btn-container">
        <a th:href="@{|/projects/${project.id}/posts|}" class="btn btn-secondary btn-fixed">ëª©ë¡ìœ¼ë¡œ</a>

        <div class="author-actions" th:if="${post.memberId == loginMemberId}">
            <a th:href="@{|/projects/${project.id}/posts/${post.id}/edit|}"
               class="btn btn-outline btn-fixed">ìˆ˜ì •</a>

            <form th:action="@{|/projects/${project.id}/posts/${post.id}/delete|}" method="post" style="margin:0;">
                <button type="submit" class="btn btn-danger btn-fixed"
                        onclick="return confirm('ì •ë§ ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                    ì‚­ì œ
                </button>
            </form>
        </div>
    </div>


    <div class="reply-section">
        <div class="reply-header">
            ğŸ’¬ ëŒ“ê¸€ <span style="color: #007bff;" th:text="${replies.size()}">2</span>
        </div>

        <div class="reply-list">
            <div th:if="${replies.isEmpty()}" style="text-align: center; padding: 30px; color: #999; background: #fff; border-bottom: 1px solid #eee;">
                ì²« ë²ˆì§¸ ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”!
            </div>

            <div th:each="reply : ${replies}" class="reply-item">
                <div class="reply-meta">
                    <div>
                        <span class="reply-author" th:text="${reply.name}">ì‘ì„±ìëª…</span>
                        <span class="reply-date" th:text="${#temporals.format(reply.modifiedAt, 'yyyy-MM-dd HH:mm')}">
                            2025-11-25 20:00
                        </span>
                    </div>

                    <form th:if="${reply.memberId == loginMemberId}"
                          th:action="@{|/projects/${project.id}/posts/${post.id}/replies/${reply.id}/delete|}"
                          method="post" style="margin: 0;">
                        <button type="submit" class="btn-reply-delete"
                                onclick="return confirm('ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">ì‚­ì œ</button>
                    </form>
                </div>

                <div class="reply-content" th:text="${reply.content}">ëŒ“ê¸€ ë‚´ìš©...</div>
            </div>
        </div>

        <div class="reply-form">
            <form th:action="@{|/projects/${project.id}/posts/${post.id}/replies|}" method="post" th:object="${replyDto}">
                <textarea class="reply-textarea" th:field="*{content}" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..." required></textarea>
                <div style="text-align: right;">
                    <button type="submit" class="btn btn-primary btn-fixed" style="height: 36px !important; padding: 0 15px !important; font-size: 13px !important;">
                        ëŒ“ê¸€ ë“±ë¡
                    </button>
                </div>
            </form>
        </div>
    </div>

</div>

</body>
</html>